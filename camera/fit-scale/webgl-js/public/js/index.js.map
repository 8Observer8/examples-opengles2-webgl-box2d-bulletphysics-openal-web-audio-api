{"version":3,"file":"index.js","sources":["../../src/webgl-context.js","../../src/shader-program.js","../../src/index.js"],"sourcesContent":["export let gl = null;\r\n\r\nexport function initWebGLContext(canvasName) {\r\n    const canvas = document.getElementById(canvasName);\r\n    if (canvas === null) {\r\n        console.log(`Failed to get a canvas element with the name \"${canvasName}\"`);\r\n        return false;\r\n    }\r\n    gl = canvas.getContext(\"webgl\", { alpha: false, premultipliedAlpha: false });\r\n    return true;\r\n}\r\n","import { gl } from \"./webgl-context.js\";\r\n\r\nexport default async function createProgram(path, vertShaderFileName,\r\n    fragShaderFileName) //\r\n{\r\n    let response = await fetch(path + vertShaderFileName);\r\n    const vertShaderSource = await response.text();\r\n    response = await fetch(path + fragShaderFileName);\r\n    const fragShaderSource = await response.text();\r\n\r\n    const vShader = gl.createShader(gl.VERTEX_SHADER);\r\n    gl.shaderSource(vShader, vertShaderSource);\r\n    gl.compileShader(vShader);\r\n    let ok = gl.getShaderParameter(vShader, gl.COMPILE_STATUS);\r\n    if (!ok) {\r\n        console.log(`${vertShaderFileName}: ${gl.getShaderInfoLog(vShader)}`);\r\n        return null;\r\n    };\r\n\r\n    const fShader = gl.createShader(gl.FRAGMENT_SHADER);\r\n    gl.shaderSource(fShader, fragShaderSource);\r\n    gl.compileShader(fShader);\r\n    ok = gl.getShaderParameter(fShader, gl.COMPILE_STATUS);\r\n    if (!ok) {\r\n        console.log(`${fragShaderFileName}: ${gl.getShaderInfoLog(fShader)}`);\r\n        return null;\r\n    };\r\n\r\n    const program = gl.createProgram();\r\n    gl.attachShader(program, vShader);\r\n    gl.attachShader(program, fShader);\r\n    gl.linkProgram(program);\r\n    ok = gl.getProgramParameter(program, gl.LINK_STATUS);\r\n    if (!ok) {\r\n        console.log(`Link error with shaders ${vertShaderFileName}` +\r\n            ` and ${fragShaderFileName}`);\r\n        console.log(gl.getProgramInfoLog(program));\r\n        return null;\r\n    };\r\n    gl.useProgram(program);\r\n\r\n    return program;\r\n}\r\n","import { glMatrix, mat4 } from \"gl-matrix\";\r\nimport { gl, initWebGLContext } from \"./webgl-context.js\";\r\nimport createProgram from \"./shader-program.js\";\r\n\r\nlet aPositionLocation, vertPosBuffer;\r\nlet uColorLocation, uMvpMatrixLocation;\r\nlet viewportX, viewportY, viewportWidth, viewportHeight;\r\n\r\n// Set up the model-view-projection matrix\r\nconst mvpMatrix = mat4.create();\r\nconst modelMatrix = mat4.create();\r\nconst viewMatrix = mat4.create();\r\nconst projMatrix = mat4.create();\r\nconst projViewMatrix = mat4.create();\r\nmat4.lookAt(viewMatrix, [0, 0, 1], [0, 0, 0], [0, 1, 0]);\r\n\r\nasync function init() {\r\n    if (!initWebGLContext(\"renderCanvas\")) {\r\n        return;\r\n    }\r\n\r\n    const shaderProgram = await createProgram(\"assets/shaders/\",\r\n        \"color.vert\", \"color.frag\");\r\n\r\n    const vertPositions = [\r\n        -0.5, -0.5,\r\n        0.5, -0.5,\r\n        -0.5, 0.5,\r\n        0.5, 0.5\r\n    ];\r\n    vertPosBuffer = gl.createBuffer();\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, vertPosBuffer);\r\n    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertPositions), gl.STATIC_DRAW);\r\n    // Set up the position attribute\r\n    aPositionLocation = gl.getAttribLocation(shaderProgram, \"aPosition\");\r\n\r\n    uMvpMatrixLocation = gl.getUniformLocation(shaderProgram, \"uMvpMatrix\");\r\n    uColorLocation = gl.getUniformLocation(shaderProgram, \"uColor\");\r\n\r\n    const worldWidth = 200;\r\n    const worldHeight = 100;\r\n    const worldAspect = worldWidth / worldHeight;\r\n\r\n    window.onresize = () => {\r\n        const w = gl.canvas.clientWidth;\r\n        const h = gl.canvas.clientHeight;\r\n        gl.canvas.width = w;\r\n        gl.canvas.height = h;\r\n        const canvasAspect = w / h;\r\n\r\n        if (worldAspect > canvasAspect) {\r\n            viewportWidth = w;\r\n            viewportHeight = viewportWidth / worldAspect;\r\n            viewportX = 0;\r\n            viewportY = (h - viewportHeight) / 2;\r\n        } else {\r\n            viewportHeight = h;\r\n            viewportWidth = viewportHeight * worldAspect;\r\n            viewportX = (w - viewportWidth) / 2;\r\n            viewportY = 0\r\n        }\r\n\r\n        mat4.identity(projMatrix);\r\n        mat4.ortho(projMatrix, 0, worldWidth, 0, worldHeight, 1, -1);\r\n        mat4.mul(projViewMatrix, projMatrix, viewMatrix);\r\n\r\n        draw();\r\n    };\r\n    window.onresize(null);\r\n}\r\n\r\ninit();\r\n\r\nfunction draw() {\r\n    console.log(viewportX, viewportY, viewportWidth, viewportHeight);\r\n    gl.clearColor(0.2, 0.2, 0.2, 1);\r\n    gl.clear(gl.COLOR_BUFFER_BIT);\r\n    gl.viewport(viewportX, viewportY, viewportWidth, viewportHeight);\r\n    gl.scissor(viewportX, viewportY, viewportWidth, viewportHeight);\r\n    gl.clearColor(0.04, 0.62, 0.48, 1);\r\n    gl.enable(gl.SCISSOR_TEST);\r\n    gl.clear(gl.COLOR_BUFFER_BIT);\r\n    gl.disable(gl.SCISSOR_TEST);\r\n\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, vertPosBuffer);\r\n    gl.vertexAttribPointer(aPositionLocation, 2, gl.FLOAT, false, 0, 0);\r\n    gl.enableVertexAttribArray(aPositionLocation);\r\n\r\n    // Square\r\n    drawRectangle(100, 50, 50, 50, 0, [0.3, 0.07, 0.5]);\r\n    // Border color\r\n    const borderColor = [0.62, 0.04, 0.18];\r\n    // Left border\r\n    drawRectangle(5, 50, 5, 85, 0, borderColor);\r\n    // Right border\r\n    drawRectangle(195, 50, 5, 85, 0, borderColor);\r\n    // Top border\r\n    drawRectangle(100, 95, 185, 5, 0, borderColor);\r\n    // Bottom border\r\n    drawRectangle(100, 5, 185, 5, 0, borderColor);\r\n}\r\n\r\nfunction drawRectangle(x, y, w, h, angle, color) {\r\n    mat4.identity(modelMatrix);\r\n    mat4.translate(modelMatrix, modelMatrix, [x, y, 0]);\r\n    mat4.rotateZ(modelMatrix, modelMatrix, glMatrix.toRadian(angle));\r\n    mat4.scale(modelMatrix, modelMatrix, [w, h, 1]);\r\n    mat4.mul(mvpMatrix, projViewMatrix, modelMatrix);\r\n    gl.uniformMatrix4fv(uMvpMatrixLocation, false, mvpMatrix);\r\n    gl.uniform3fv(uColorLocation, color);\r\n    gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\r\n}\r\n"],"names":[],"mappings":"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"}